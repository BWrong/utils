!function(e,i){"object"==typeof exports&&"undefined"!=typeof module?i(exports):"function"==typeof define&&define.amd?define(["exports"],i):i((e="undefined"!=typeof globalThis?globalThis:e||self).authTool={})}(this,(function(e){"use strict";var i={install:function(e,i){var r=void 0===i?{}:i,n=r.directiveName,t=void 0===n?"auth":n,o=r.hasAuth,a=void 0===o?function(e){return!0}:o;e.version.match(/^3/)?e.directive(t,{mounted:function(e,i){var r;!a(i.value)&&(null===(r=e.parentNode)||void 0===r||r.removeChild(e))}}):e.directive(t,{inserted:function(e,i){var r;!a(i.value)&&(null===(r=e.parentNode)||void 0===r||r.removeChild(e))}})}};var r=function(e,i){var r;return!(null===(r=e.meta)||void 0===r?void 0:r.permission)||!!i[e.meta.permission]},n=function(e,i){return Object.assign(e,i)};function t(e,i,o,a,u){return void 0===e&&(e=[]),void 0===i&&(i={}),void 0===o&&(o=""),void 0===a&&(a=r),void 0===u&&(u=n),e.filter((function(e){var r;return!!a(e,i)&&((null===(r=e.meta)||void 0===r?void 0:r.permission)&&(e.path=e.path.match(/^\/.+/)?e.path:"".concat(o,"/").concat(e.path),d[e.meta.permission]=e,e.meta=u(e.meta,i[e.meta.permission])),e.children&&(e.children=t(e.children,i,e.path)),!0)}))}function o(e,i,r){return void 0===e&&(e={}),void 0===i&&(i=[]),void 0===r&&(r=u),i.map((function(n){var t,a;return n.url=n.url||n[r]&&(null===(t=e[n[r]])||void 0===t?void 0:t.path)||"",(null===(a=n.children)||void 0===a?void 0:a.length)&&(n.children=o(e,i,r)),n}))}function a(e,i){return Array.isArray(e)||(console.error("@bwrong/auth-tool/ganerAuthData: ".concat(i,"参数传入数据类型不正确，请传入Array数据类型")),!1)}var d={},u="permission",v=function(){return v=Object.assign||function(e){for(var i,r=1,n=arguments.length;r<n;r++)for(var t in i=arguments[r])Object.prototype.hasOwnProperty.call(i,t)&&(e[t]=i[t]);return e},v.apply(this,arguments)};var c=Object.freeze({__proto__:null,convertArrayToTree:function(e){var i=e.data,r=void 0===i?[]:i,n=e.pid,t=void 0===n?0:n,o=e.children,a=void 0===o?"children":o,d=e.pidName,u=void 0===d?"parentId":d,v=e.idName,c=void 0===v?"id":v,l=[],s={};return r.forEach((function(e){e[a]=s[e[c]]=s[e[c]]||[],e[u]?(s[e[u]]=s[e[u]]||[],s[e[u]].push(e)):l.push(e)})),t?s[t]:l},convertTreeToArray:function e(i,r){return void 0===r&&(r=[]),i.forEach((function(i){var n;r.push(v(v({},i),{children:[]})),(null===(n=i.children)||void 0===n?void 0:n.length)&&e(i.children,r)})),r},getParentsFromArray:function e(i){for(var r=i.id,n=i.data,t=i.idName,o=void 0===t?"id":t,a=i.pidName,d=void 0===a?"parentId":a,u=i.result,v=void 0===u?[]:u,c=0,l=n;c<l.length;c++){var s=l[c];s[o]===r&&(v.unshift(s),e({id:s[d],data:n,idName:o,pidName:d,result:v}))}return v}}),l=c;e.authDirective=i,e.ganerAuthData=function(e){var i=e.routes,v=void 0===i?[]:i,c=e.permissions,l=void 0===c?[]:c,s=e.authKey,h=void 0===s?u:s,f=e.checkAuth,p=void 0===f?r:f,m=e.mergeMeta,y=void 0===m?n:m,g=e.prefix,A=void 0===g?"":g;a(v,"routes"),a(l,"permissions");var N=function(e,i){return void 0===e&&(e=[]),void 0===i&&(i=u),e.reduce((function(e,r){return e[r[i]]=r,e}),{})}(l,h);return{authMap:N,routes:t(v,N,A,p,y),menus:o(d,l,h)}},e.util=l}));
