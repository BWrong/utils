!function(e,i){"object"==typeof exports&&"undefined"!=typeof module?i(exports):"function"==typeof define&&define.amd?define(["exports"],i):i((e="undefined"!=typeof globalThis?globalThis:e||self).authTool={})}(this,(function(e){"use strict";var i={install:function(e,i){var r=void 0===i?{}:i,n=r.directiveName,t=void 0===n?"auth":n,o=r.hasAuth,a=void 0===o?function(e){return!0}:o;e.version.match(/^3/)?e.directive(t,{mounted:function(e,i){var r;!a(i.value)&&(null===(r=e.parentNode)||void 0===r||r.removeChild(e))}}):e.directive(t,{inserted:function(e,i){var r;!a(i.value)&&(null===(r=e.parentNode)||void 0===r||r.removeChild(e))}})}};var r=function(){return r=Object.assign||function(e){for(var i,r=1,n=arguments.length;r<n;r++)for(var t in i=arguments[r])Object.prototype.hasOwnProperty.call(i,t)&&(e[t]=i[t]);return e},r.apply(this,arguments)};var n=function(e,i){var r;return!(null===(r=e.meta)||void 0===r?void 0:r.permission)||!!i[e.meta.permission]},t=function(e,i){return Object.assign(e,i)};function o(e,i,a,d,v){return void 0===e&&(e=[]),void 0===i&&(i={}),void 0===a&&(a=""),void 0===d&&(d=n),void 0===v&&(v=t),e.filter((function(e){var n,t=r({},e);return!!d(t,i)&&((null===(n=t.meta)||void 0===n?void 0:n.permission)&&(t.path=t.path.match(/^\/.+/)?t.path:"".concat(a,"/").concat(t.path),u[t.meta.permission]=t,t.meta=v(t.meta,i[t.meta.permission])),t.children&&(t.children=o(t.children,i,t.path)),!0)}))}function a(e,i,r){return void 0===e&&(e={}),void 0===i&&(i=[]),void 0===r&&(r=v),i.map((function(n){var t,o;return n.url=n.url||n[r]&&(null===(t=e[n[r]])||void 0===t?void 0:t.path)||"",(null===(o=n.children)||void 0===o?void 0:o.length)&&(n.children=a(e,i,r)),n}))}function d(e,i){return Array.isArray(e)||(console.error("@bwrong/auth-tool/ganerAuthData: ".concat(i,"参数传入数据类型不正确，请传入Array数据类型")),!1)}var u={},v="permission";var c=Object.freeze({__proto__:null,convertArrayToTree:function(e){var i=e.data,r=void 0===i?[]:i,n=e.pid,t=void 0===n?0:n,o=e.children,a=void 0===o?"children":o,d=e.pidName,u=void 0===d?"parentId":d,v=e.idName,c=void 0===v?"id":v,l=[],s={};return r.forEach((function(e){e[a]=s[e[c]]=s[e[c]]||[],e[u]?(s[e[u]]=s[e[u]]||[],s[e[u]].push(e)):l.push(e)})),t?s[t]:l},convertTreeToArray:function e(i,n){return void 0===n&&(n=[]),i.forEach((function(i){var t;n.push(r(r({},i),{children:[]})),(null===(t=i.children)||void 0===t?void 0:t.length)&&e(i.children,n)})),n},getParentsFromArray:function e(i){for(var r=i.id,n=i.data,t=i.idName,o=void 0===t?"id":t,a=i.pidName,d=void 0===a?"parentId":a,u=i.result,v=void 0===u?[]:u,c=0,l=n;c<l.length;c++){var s=l[c];s[o]===r&&(v.unshift(s),e({id:s[d],data:n,idName:o,pidName:d,result:v}))}return v}}),l=c;e.authDirective=i,e.ganerAuthData=function(e){var i=e.routes,r=void 0===i?[]:i,c=e.permissions,l=void 0===c?[]:c,s=e.authKey,h=void 0===s?v:s,f=e.checkAuth,p=void 0===f?n:f,m=e.mergeMeta,y=void 0===m?t:m,g=e.prefix,A=void 0===g?"":g;d(r,"routes"),d(l,"permissions");var N=function(e,i){return void 0===e&&(e=[]),void 0===i&&(i=v),e.reduce((function(e,r){return e[r[i]]=r,e}),{})}(l,h);return{authMap:N,routes:o(r,N,A,p,y),menus:a(u,l,h)}},e.util=l}));
